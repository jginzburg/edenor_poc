<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd        http://camel.apache.org/schema/spring       http://camel.apache.org/schema/spring/camel-spring.xsd">
    <bean class="org.apache.commons.dbcp.BasicDataSource"
        destroy-method="close" id="mysql">
        <property name="driverClassName" value="com.mysql.jdbc.Driver"/>
        <property name="url" value="jdbc:mysql://localhost/edenorpoc"/>
        <property name="username" value="guest"/>
        <property name="password" value="redhat01"/>
    </bean>
    <camelContext id="camel" xmlns="http://camel.apache.org/schema/spring">
        <route id="CSVImport">
            <!-- 			<from uri="ftp:epiz_23713101@ftpupload.net/htdocs/?password=XovGP9Ze&amp;move=.procesados"/> -->
         
            <from id="_from1" uri="sftp:guest@localhost/pendientes?password=redhat01&amp;include=.NT100270319.TXT&amp;move=../procesados"/>
            <log id="logfile" loggingLevel="INFO" message=">>>>>>>>>>>>>>>>****comenzando lectura"/>
            <split id="SplitRecords" parallelProcessing="true" streaming="true">
                <tokenize token="\n"/>
                <unmarshal id="_unmarshal1">
                    <csv delimiter="|" lazyLoad="true"/>
                </unmarshal>
                <doTry id="_doTry1">
                    <transform id="_transform1">
                        <simple>${body[0]}</simple>
                    </transform>
                    <!-- 				<log id="logEachCSVRecord" loggingLevel="INFO" message="Process CSV record: ${body}"/> -->
                    <!-- 				<log id="route-log" message=">>> ${body}"/>  -->
                    <to id="_to1" uri="sql:INSERT INTO liquidacion(        Id_Sistema,        Id_Usuar,        Fecha_Lect,        Nro_Fact,        Tarifa,        SubCatTar,        TS,        EBP,        MAU,        ELD,        Tension,        Tipo_Fact,        Tipo_Lec,        Tipo_Per,        Periodo,        Liquidacion,        Nro_Fact_Orig,        Per_Ref_Base,        Cod_Exc_Base,        Fecha_Emision,        Fecha_Vto_1,        Fecha_Vto_2,        Cambio_Medidor,        nada       ) VALUES(#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#       )?dataSource=#mysql"/>
                    <doCatch id="_doCatch1">
                        <exception>java.lang.Exception</exception>
                        <log id="_log1" message="ERROR procesando linea # ${property.CamelSplitIndex}. ${exception.message}"/>
                    </doCatch>
                </doTry>
            </split>
            <log id="logfile" loggingLevel="INFO" message=">>>>>>>>>>>>>>>>****finalizada lectura"/>
        </route>
        <!--         <route id="simple-route"> -->
        <!--             <from id="route-timer" uri="timer://foo?period=1000"/> -->
        <!--             <setBody id="route-setBody"> -->
        <!--                 <simple>Hello World from camel-context.xml</simple> -->
        <!--             </setBody> -->
        <!--             <log id="route-log" message=">>> ${body}"/> -->
        <!--         </route> -->
    </camelContext>
</beans>
